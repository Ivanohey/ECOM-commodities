---
author: "Ivan Kostine, Charl√®ne Khairallah, Niccolo Cherubini"
date: "2023-11-18"
output: html_document
---

```{r Import and clean names, include=FALSE}
# Create an empty list to store the data frames
commodity_data_list <- list()

# List of commodity sheet names
commodities <- c(
  "Cotton", "Cocoa", "Silver", "CrudeOil", "Sugar", "NagGas", "HeatOil",
  "Gasoline", "Corn", "Soybeans", "SoyOil", "SoyMeal", "Wheat", "Gold",
  "Platinum", "Palladium", "FedCattle", "LiveCattle", "LeanHogs","Copper", "Coffee"
)

# Load data for each commodity and store it in the list
for (commodity in commodities) {
  data <- read_excel("data/COT_Disaggreated_FuturesAndOptionsCombined.xlsx", sheet = commodity) %>% rename(
    "Open_Interest" = "Open Interest",
    "Producer_Longs"="Producer/Merchant/Processor/User Longs",
    "Producer_Shorts"="Producer/Merchant/Processor/User Shorts",
    "Swap_Dealer_Longs"="Swap Dealer Longs",
    "Swap_Dealer_Shorts"="Swap Dealer Shorts",
    "Swap_Dealer_Spreads"="Swap Dealer Spreads",
    "Money_Manager_Longs"="Money Manager Longs",
    "Money_Manager_Shorts"="Money Manager Shorts",
    "Money_Manager_Spreads"="Money Manager Spreads",
    "Other_Reportable_Longs"="Other Reportable Longs",
    "Other_Reportable_Shorts"="Other Reportable Shorts",
    "Other_Reportable_Shorts"="Other Reportable Shorts",
    "Total_Reportable_Longs"="Total Reportable Longs",
    "Total_Reportable_Shorts"="Total Reportable Shorts",
    "Non_Reportable_Longs"="Non Reportable Longs",
    "Non_Reportable_Shorts"="Non Reportable Shorts") %>% as_tsibble(index = Date, regular = FALSE)
  commodity_data_list[[commodity]] <- data
}


```




```{r creating COT dfs}
#Softs
COT_Cotton<- commodity_data_list[["Cotton"]]
COT_Cocoa<- commodity_data_list[["Cocoa"]]
COT_Coffee<- commodity_data_list[["Coffee"]]
COT_Sugar<- commodity_data_list[["Sugar"]]


#Other
# COT_Silver<- read_excel("data/COT_Disaggreated_FuturesAndOptionsCombined.xlsx", sheet="Silver") %>% as_tsibble(index= Date, regular=FALSE)
# COT_CrudeOil<- read_excel("data/COT_Disaggreated_FuturesAndOptionsCombined.xlsx", sheet="CrudeOil") %>% as_tsibble(index= Date, regular=FALSE)
# COT_NagGas<- read_excel("data/COT_Disaggreated_FuturesAndOptionsCombined.xlsx", sheet="NagGas") %>% as_tsibble(index= Date, regular=FALSE)
# COT_HeatOil<- read_excel("data/COT_Disaggreated_FuturesAndOptionsCombined.xlsx", sheet="HeatOil") %>% as_tsibble(index= Date, regular=FALSE)
# COT_Gasoline<- read_excel("data/COT_Disaggreated_FuturesAndOptionsCombined.xlsx", sheet="Gasoline") %>% as_tsibble(index= Date, regular=FALSE)
# COT_Corn<- read_excel("data/COT_Disaggreated_FuturesAndOptionsCombined.xlsx", sheet="Corn") %>% as_tsibble(index= Date, regular=FALSE)
# COT_Soybeans<- read_excel("data/COT_Disaggreated_FuturesAndOptionsCombined.xlsx", sheet="Soybeans") %>% as_tsibble(index= Date, regular=FALSE)
# COT_SoyOil<- read_excel("data/COT_Disaggreated_FuturesAndOptionsCombined.xlsx", sheet="SoyOil") %>% as_tsibble(index= Date, regular=FALSE)
# COT_SoyMeal<- read_excel("data/COT_Disaggreated_FuturesAndOptionsCombined.xlsx", sheet="SoyMeal") %>% as_tsibble(index= Date, regular=FALSE)
# COT_Wheat<- read_excel("data/COT_Disaggreated_FuturesAndOptionsCombined.xlsx", sheet="Wheat") %>% as_tsibble(index= Date, regular=FALSE)
# COT_Gold<- read_excel("data/COT_Disaggreated_FuturesAndOptionsCombined.xlsx", sheet="Gold") %>% as_tsibble(index= Date, regular=FALSE)
# COT_Platinum<- read_excel("data/COT_Disaggreated_FuturesAndOptionsCombined.xlsx", sheet="Platinum") %>% as_tsibble(index= Date, regular=FALSE)
# COT_Palladium<- read_excel("data/COT_Disaggreated_FuturesAndOptionsCombined.xlsx", sheet="Palladium") %>% as_tsibble(index= Date, regular=FALSE)
# COT_FedCattle<- read_excel("data/COT_Disaggreated_FuturesAndOptionsCombined.xlsx", sheet="FedCattle") %>% as_tsibble(index= Date, regular=FALSE)
# COT_LiveCattle<- read_excel("data/COT_Disaggreated_FuturesAndOptionsCombined.xlsx", sheet="LiveCattle") %>% as_tsibble(index= Date, regular=FALSE)
# COT_LeanHogs<- read_excel("data/COT_Disaggreated_FuturesAndOptionsCombined.xlsx", sheet="LeanHogs") %>% as_tsibble(index= Date, regular=FALSE)
# COT_Copper<- read_excel("data/COT_Disaggreated_FuturesAndOptionsCombined.xlsx", sheet="Copper") %>% as_tsibble(index= Date, regular=FALSE)




```