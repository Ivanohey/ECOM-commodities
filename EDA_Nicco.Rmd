```{r import_data}
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(readxl)
library(lubridate)
library(DataExplorer)
library(corrplot)
library(GGally)
library(DT)

#web scrapping
#library(rvest)

#cleaning 
library(summarytools)
library(imputeTS)

#Forecasting 
library(tsibble)
library(fpp3)
library(ggfortify)

```

```{r}
Daily_futures_prices <- read_excel("data/DailyFuturePrices_2003_2023.xlsx", sheet="Original")

Daily_futures_prices <- Daily_futures_prices[, c(1:13, 53:55)]
Daily_futures_prices <- Daily_futures_prices[-c(1,2),]
colnames(Daily_futures_prices)[1] ="Date"
Daily_futures_prices[, 2:16] <- lapply(2:16, function(x) as.numeric(Daily_futures_prices[[x]]))


commo_mean <- function(set) {
  result_set <- set %>% 
    mutate(Date,
           Cotton = rowMeans(select(., as.numeric(2:4)), na.rm = TRUE),
           Coffee = rowMeans(select(., 5:7),na.rm = TRUE),
           Sugar = rowMeans(select(., 8:10),na.rm = TRUE),
           Cocoa = rowMeans(select(., 11:13), na.rm = TRUE),
           Oil = rowMeans(select(., 14:16), na.rm = TRUE),.keep = "none")
  
  return(result_set)
}

# Compute mean by group
commo_prices <- commo_mean(Daily_futures_prices)

```

```{r}

Cotton_futures <- commo_prices %>%
    ggplot(aes(x = Date, y = Cotton)) +
    geom_area(fill = "#69b3a2", alpha = 0.5) +
    geom_line(color = "#69b3a2") +
    ylab(paste("Futures Price of Cotton")) +
    theme_ipsum()
    
  interactive_futures_price_chart <- ggplotly(Cotton_futures)
  
  # Display the interactive area chart
  print(interactive_futures_price_chart)

```




```{r}
library(ggplot2)
library(dplyr)
library(plotly)
library(hrbrthemes)

# # Create and display interactive area charts for "Open Interest" for each commodity
# for (commodity_name in Daily_futures_prices) {
#   
#  futures_prices_chart <- Daily_futures_prices %>%
#     ggplot(aes(x = Date, y = `commodity_name`)) +
#     geom_area(fill = "#69b3a2", alpha = 0.5) +
#     geom_line(color = "#69b3a2") +
#     ylab(paste("Futures Price of", commodity_name)) +
#     theme_ipsum()
#   
#   interactive_futures_price_chart <- ggplotly(futures_prices_chart)
#   
#   # Display the interactive area chart
#   print(interactive_futures_price_chart)
# }



```


